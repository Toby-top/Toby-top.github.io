<head>
    <link rel="stylesheet" href="/css/style.css">
</head>

<div class="post-container">

    <div class="post-title">Hello World!</div>

    <div class="post-date">2025.12.06 10:45</div>

    <div class="post-content">
        即使世界毁灭，我也想再见你一面<br>
        -----《你好世界》
    </div>

</div>

<!-- 评论系统 -->
<h2 class="comment-title">评论区</h2>

<div class="comment-box">
    <input id="nickname" type="text" placeholder="你的昵称（必填）">

    <textarea id="commentText" placeholder="写点什么吧…（必填）"></textarea>

    <button onclick="postComment()">发布</button>
</div>

<div id="commentList"></div>

<script>
// 获取系统信息
function detectSystem() {
    const ua = navigator.userAgent;

    let os = "Unknown OS";
    if (/Windows/i.test(ua)) os = "Windows";
    else if (/Macintosh|Mac OS X/i.test(ua)) os = "macOS";
    else if (/Android/i.test(ua)) os = "Android";
    else if (/iPhone|iPad/i.test(ua)) os = "iOS";
    else if (/Linux/i.test(ua)) os = "Linux";

    let browser = "Unknown Browser";
    if (/Firefox/i.test(ua)) browser = "Firefox";
    else if (/Chrome/i.test(ua) && !/Edg/i.test(ua)) browser = "Chrome";
    else if (/Safari/i.test(ua) && !/Chrome/i.test(ua)) browser = "Safari";
    else if (/Edg/i.test(ua)) browser = "Edge";

    return `${os} / ${browser}`;
}

// 加载评论
function loadComments() {
    const saved = JSON.parse(localStorage.getItem("comments_hw") || "[]");
    const list = document.getElementById("commentList");
    list.innerHTML = "";

    saved.forEach(c => {
        const div = document.createElement("div");
        div.className = "comment-card";
        div.innerHTML = `
            <div class="comment-header">
                <span class="nickname">${c.nickname}</span>
                <span class="meta">${c.device}</span>
            </div>
            <div class="content">${c.text}</div>
            <div class="time">${c.time}</div>
        `;
        list.appendChild(div);
    });
}

// 发表评论
function postComment() {
    const nickname = document.getElementById("nickname").value.trim();
    const text = document.getElementById("commentText").value.trim();

    if (!nickname || !text) {
        alert("昵称和内容不能为空！");
        return;
    }

    const device = detectSystem();
    const time = new Date().toLocaleString();

    const comment = { nickname, text, device, time };

    const saved = JSON.parse(localStorage.getItem("comments_hw") || "[]");
    saved.unshift(comment);
    localStorage.setItem("comments_hw", JSON.stringify(saved));

    document.getElementById("commentText").value = "";
    loadComments();
}

loadComments();
</script>
